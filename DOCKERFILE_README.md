# AI-Generated Dockerfile

This Dockerfile was generated using DSPy Chain of Thought reasoning on 2025-08-22 14:48:16 UTC.

## Generation Strategy

1. **Multi-Stage Build:**  
   - Stage 1: Use official Node.js image to build the frontend. Only copy the necessary files (`package.json`, `yarn.lock`, `vite.config.ts`, `tsconfig.json`, `src/`, etc.) to leverage caching and minimize context.
   - Stage 2: Use official Python slim image (`python:3.11-slim`) for backend. Install only production dependencies from `requirements.txt` and `pyproject.toml` using `pip install --no-cache-dir`.
   - Copy the built frontend assets from Stage 1 into the backend's expected dist directory (`py-src/data_formulator/dist`).

2. **Security:**  
   - Create and use a non-root user for running the backend.
   - Do not copy `.env.template` or `api-keys.env.template` as secrets; only copy them as templates for documentation.
   - Use `.dockerignore` to exclude node_modules, test files, docs, and other unnecessary files.

3. **Performance:**  
   - Use layer caching for dependency installation (`yarn install`, `pip install`).
   - Clean up caches in the same RUN layer.
   - Only copy necessary files/artifacts between stages.

4. **Entrypoint & Healthcheck:**  
   - Use `CMD ["python", "-m", "data_formulator"]` for backend startup.
   - Add a healthcheck to verify Flask is running on `/api/health`.

5. **Documentation & Flexibility:**  
   - EXPOSE port 5000.
   - Document environment variable usage.
   - Allow mounting of `.env` and `api-keys.env` at runtime.

## Build Instructions

```bash
# Build the image
docker build -t data-formulator .

# Run the container
docker run -p 5000:5000 data-formulator
```

## Features

- Multi-stage build for optimal image size
- Security best practices (non-root user)
- Health checks for production readiness
- Caching-optimized layer structure
- Production environment configuration

Generated by: Prism AI Workflow Orchestrator
Tool: Dockerfile Generator (Pure LLM Chain of Thought)
